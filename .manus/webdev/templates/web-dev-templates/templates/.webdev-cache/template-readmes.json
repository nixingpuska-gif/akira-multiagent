{
  "web-db-user": "# Web App Template (tRPC + Manus Auth + Database)\n\nThis template gives you a React 19 + Tailwind 4 + Express 4 + tRPC 11 stack with Manus OAuth already wired. Procedures are your contracts, types flow end to end, and authentication \"just works\".\n\n---\n\n## Quick Facts\n\n- **tRPC-first:** define procedures in `server/routers.ts`, consume them with `trpc.*` hooks.\n- **Superjson out of the box:** return Drizzle rows directly‚Äî`Date` stays a `Date`.\n- **Auth baked in:** `/api/oauth/callback` handles Manus OAuth, `protectedProcedure` injects `ctx.user`.\n- **Gateway-ready:** all RPC traffic is under `/api/trpc`, making it easy to route at the edge.\n\n---\n\n## Build Loop (Four Touch Points)\n\n1. Update schema in `drizzle/schema.ts`, then run `pnpm db:push`.\n2. Add database helpers in `server/db.ts` (return raw results).\n3. Add or extend procedures in `server/routers.ts`, then wire the UI with `trpc.*.useQuery/useMutation`.\n4. Build frontend experience according to `Frontend Workflow`\n5. Cover your changes with Vitest specs inside `server/*.test.ts` (see `server/auth.logout.test.ts`) and run `pnpm test`.\n\nThat's it‚Äîno manual REST routes, no Axios client, no shared contract files.\n\n---\n\n## Key Files\n\n```\nserver/auth.logout.test.ts ‚Üí Reference sample vitest test file\ndrizzle/schema.ts ‚Üí Database tables & types\nserver/db.ts ‚Üí Query helpers (reuse across procedures)\nserver/routers.ts ‚Üí tRPC procedures (auth + features)\nclient/src/App.tsx ‚Üí Routes wiring & layout shells\nclient/src/lib/trpc.ts ‚Üí tRPC client binding\nclient/src/pages/ ‚Üí Feature UI that calls trpc hooks\n```\n\nFramework plumbing (OAuth, context, Vite bridge) lives under `server/_core`.\n\n---\n\n## File Structure\n\n```\nclient/\n  public/         ‚Üê Static assets copied verbatim to '/'\n  src/\n    pages/        ‚Üê Page-level components\n    components/   ‚Üê Reusable UI & shadcn/ui\n    contexts/     ‚Üê React contexts\n    hooks/        ‚Üê Custom hooks\n    lib/trpc.ts   ‚Üê tRPC client\n    App.tsx       ‚Üê Routes & layout\n    main.tsx      ‚Üê Providers\n    index.css     ‚Üê global style\ndrizzle/          ‚Üê Schema & migrations\nserver/\n  db.ts           ‚Üê Query helpers\n  routers.ts      ‚Üê tRPC procedures\nstorage/          ‚Üê S3 helpers\nshared/           ‚Üê Shared constants & types\n```\n\nOnly touch the files under \"‚Üê\" markers. Anything under `server/_core` or other tooling directories is framework-level‚Äîavoid editing unless you are extending the infrastructure.\n\nAssets placed under `client/public` are served with aggressive caching, so add a content hash to filenames (for example, `asset.3fa9b2e4.svg`) whenever you replace a file and update its references to avoid stale assets.\n\nFiles in `client/public` are available at the root of your site‚Äîreference them with absolute paths (`/asset.3fa9b2e4.svg`, `/robots.txt`, etc.) from HTML templates, JSX, or meta tags.\n\n---\n\n## Authentication Flow\n\n- Manus OAuth completes at `/api/oauth/callback` and drops a session cookie.\n- Each request to `/api/trpc` builds context via `server/_core/context.ts`, making the current user available as `ctx.user`.\n- Wrap protected logic in `protectedProcedure`; public access uses `publicProcedure`.\n- Frontend reads auth state with `trpc.auth.me.useQuery()` and invokes `trpc.auth.logout.useMutation()`‚Äîno cookie plumbing required.\n\n---\n\n## Environment Variables\n\nAvailable pre-defined system envs:\n- `DATABASE_URL`: MySQL/TiDB connection string\n- `JWT_SECRET`: Session cookie signing secret\n- `VITE_APP_ID`: Manus OAuth application ID\n- `OAUTH_SERVER_URL`: Manus OAuth backend base URL\n- `VITE_OAUTH_PORTAL_URL`: Manus login portal URL (frontend)\n- `OWNER_OPEN_ID`, `OWNER_NAME`: Owner's info\n- `BUILT_IN_FORGE_API_URL`: Manus built-in apis (includes llm, storage, data_api, notification, etc...)\n- `BUILT_IN_FORGE_API_KEY`: Bearer token used by Manus built-in apis (server-side)\n- `VITE_FRONTEND_FORGE_API_KEY`: Bearer token for frontend access to Manus built-in apis\n- `VITE_FRONTEND_FORGE_API_URL`: Manus built-in apis URL for frontend\n\nDo not edit these directly in code or commit `.env` files.\nThe envs above are system envs, when use env in website code, refer `server/_core/env.ts` for available list.\n\n---\n\n## Frontend Workflow\n\n1. Choose a design style before you write any frontend code according to Design Guide (color, font, shadow, art style). Remember to edit `client/src/index.css` for global theming and add needed font using google font cdn in `client/index.html`.\n2. Design the layout and navigation structure based on app purpose. Establish navigation in App.tsx accordingly:\n  - **Personal tools & internal dashboards** (finance trackers, task managers, admin panels, personal finance apps, analytics): Use DashboardLayout with sidebar navigation for consistent experience.\n  - **Public-facing products** (marketing sites, e-commerce, communities): Design custom navigation (top nav, contextual nav) and landing page to attract users.\n3. Start by updating `client/src/pages/Home.tsx` (the landing page shell) using shadcn/ui components to introduce links, CTAs, or feature entry points. \n4. Create or update additional components under `client/src/pages/FeatureName.tsx`, continuing to leverage shadcn/ui + Tailwind for consistent styling.\n5. Register the route (or navigation entry) in `client/src/App.tsx`.\n6. Read data with `const { data, isLoading } = trpc.feature.useQuery(params);`.\n7. Mutate data with `trpc.feature.useMutation()`. Use optimistic updates for list operations, toggles, and profile edits. For critical operations (payments, auth), use `invalidate` with loading states.\n8. Use `useAuth()` for current user state, login URL from `getLoginUrl()`, and avoid direct cookie handling.\n9. Handle loading/empty/error states in the UI‚ÄîtRPC already surfaces typed responses and errors.\n\n---\n\n## Frontend Development Guidelines\n\n**tRPC & Data Management:**\n- Use `trpc.*.useQuery/useMutation` for all backend calls‚Äînever introduce Axios/fetch wrappers.\n- **Use optimistic updates for instant feedback**: ideal for adding/editing/deleting list items, toggling states, updating profiles. Use `onMutate` to update cache, `onError` to rollback (The onMutate/onError/onSettled pattern). For critical operations (payments, auth), prefer `invalidate` with explicit loading states.\n- When using `invalidate` as fallback: call `trpc.useUtils().feature.invalidate()` in mutation's `onSuccess`.\n- Auth state comes from `useAuth()`; do not manipulate cookies manually.\n\n**UI & Styling:**\n- Prefer shadcn/ui components for interactions to keep a modern, consistent look; import from `@/components/ui/*` (e.g., `button`, `card`, `dialog`).\n- Compose Tailwind utilities with component variants for layout and states; avoid excessive custom CSS. Use built-in `variant`, `size`, etc. where available.\n- Preserve design tokens: keep the `@layer base` rules in `client/src/index.css`. Utilities like `border-border` and `font-sans` depend on them.\n- Consistent design language: use spacing, radius, shadows, and typography via tokens. Extract shared UI into `components/` for reuse instead of copy‚Äëpaste.\n- Accessibility and responsiveness: keep visible focus rings and ensure keyboard reachability; design mobile‚Äëfirst with thoughtful breakpoints.\n- Theming: Choose dark/light theme to start with for ThemeProvider according to your design style (dark or light bg), then manage colors pallette with CSS variables in `client/src/index.css` instead of hard‚Äëcoding to keep global consistency.\n- Micro‚Äëinteractions and empty states: add motion, empty states, and icons tastefully to improve quality without distracting from content.\n- Navigation: For internal tools/admin panels, use persistent sidebar. For public-facing apps, design navigation based on content structure (top nav, side nav, or contextual)‚Äîensure clear escape routes from all pages.\n- Placeholder UI elements: When adding structural placeholders (nav items, table actions) for not-yet-implemented features, show toast on click (\"Feature coming soon\"). Inform user which elements are placeholders when presenting work.\n\n**React Best Practices:**\n- Never call setState/navigation in render phase ‚Üí wrap in `useEffect`\n\n**Customized Defaults:**\nThis template customizes some Tailwind/shadcn defaults for simplified usage:\n- `.container` is customized to auto-center and add responsive padding (see `index.css`). Use directly without `mx-auto`/`px-*`. For custom widths, use `max-w-*` with `mx-auto px-4`.\n- `.flex` is customized to have `min-width:0` and `min-height:0` by default\n- `button` variant `outline` uses transparent background (not `bg-background`). Add bg color class manually if needed.\n\n---\n\n## üé® Design Guide\n\nWhen generating frontend UI, avoid generic patterns that lack visual distinction:\n- Avoid generic full-page centered layouts‚Äîprefer asymmetric/sidebar/grid structures for landing pages and dashboards\n- Avoid applying dashboard/sidebar patterns to public-facing apps (forums, communities, e-commerce)‚Äîreserve those for internal tools\n- When user provides vague requirements, make creative design decisions (choose specific color palette, typography, layout approach)\n- Prioritize visual diversity: combine different design systems (e.g., one color scheme + different typography + another layout principle)\n- For landing pages: prefer asymmetric layouts, specific color values (not just \"blue\"), and textured backgrounds over flat colors\n- For dashboards: use defined spacing systems, soft shadows over borders, and accent colors for hierarchy\n\n---\n\n## Feature Checklist\n\n- [ ] Tables updated in `drizzle/schema.ts`, migrations pushed (`pnpm db:push`)\n- [ ] Query helper added in `server/db.ts` (returns raw Drizzle rows)\n- [ ] Procedure created in `server/routers.ts` (choose `public` vs `protected`)\n- [ ] UI calls the procedure via `trpc.*.useQuery/useMutation`\n- [ ] Success + error paths verified in the browser\n\n---\n\n## Pre-built Components\n\nBefore implementing UI features, check if these components already exist:\n\nDashboard & Layout:\n- `client/src/components/DashboardLayout.tsx` - Full dashboard layout with sidebar navigation, auth handling, and user profile. Use this for any admin panel or dashboard-style app instead of building from scratch.\n- `client/src/components/DashboardLayoutSkeleton.tsx` - Loading skeleton for dashboard during auth checks\n\nChat & Messaging:\n- `client/src/components/AIChatBox.tsx` - Full-featured chat interface with message history, streaming support, and markdown rendering. Use this for any chat/conversation UI instead of building from scratch.\n\nMaps:\n- `client/src/components/Map.tsx` - Google Maps integration with proxy authentication. Provides MapView component with onMapReady callback for initializing Google Maps services (Places, Geocoder, Directions, Drawing, etc.). All map functionality works directly in the browser.\n\nWhen implementing features that match these categories, MUST evaluate the component first to decide whether to use or customize it.\n\n---\n\n## Internal Tools & Admin Panels\n\nFor certain app types, this template provides DashboardLayout‚Äîa standardized sidebar pattern.\n\n**Use DashboardLayout for:**\n- Admin/management dashboards\n- Personal productivity apps (task managers, note-taking)\n- Analytics/monitoring tools\n\n**Do NOT use for:**\n- Public content platforms (forums, blogs, social networks)\n- E-commerce storefronts\n- Marketing/landing sites\n\n**Layout & Navigation**\n- Use `DashboardLayout` component from `client/src/components/DashboardLayout.tsx` and remove any page-level headers to avoid duplication.\n- When use DashboardLayout, read its content before making changes and preserve its core structure by default.\n\n**Role-based Access Control**\nWhen building apps with distinct access levels (e.g., e-commerce with public home, user account, admin panel):\n- The `user` table includes a `role` field (enum: `admin` | `user`) for identity separation\n- Use `ctx.user.role` in procedures to gate admin-only operations\n- Wrap admin-only backend logic in `adminProcedure`\n- Frontend can conditionally render navigation/routes based on `useAuth().user?.role`\n\nExample procedure pattern:\n```ts\nadminOnlyProcedure: protectedProcedure.use(({ ctx, next }) => {\n  if (ctx.user.role !== 'admin') throw new TRPCError({ code: 'FORBIDDEN' });\n  return next({ ctx });\n}),\n```\n\n**Managing Admins**\n- To promote a user to admin, update the `role` field directly in the database via the system UI or SQL\n- If you need additional roles beyond `admin`/`user`, extend the enum in `drizzle/schema.ts` and push the migration\n\n---\n\n## LLM Integration\n\nUse the preconfigured LLM helpers. Credentials are injected from the platform (no manual setup required).\n\n```ts\nimport { invokeLLM } from \"./server/_core/llm\";\n\n/**\n * Simple chat completion\n * type Role = \"system\" | \"user\" | \"assistant\" | \"tool\" | \"function\";\n * type TextContent = {\n *   type: \"text\";\n *   text: string;\n * };\n *\n * type ImageContent = {\n *   type: \"image_url\";\n *   image_url: {\n *     url: string;\n *     detail?: \"auto\" | \"low\" | \"high\";\n *   };\n * };\n *\n * type FileContent = {\n *   type: \"file_url\";\n *   file_url: {\n *     url: string;\n *     mime_type?: \"audio/mpeg\" | \"audio/wav\" | \"application/pdf\" | \"audio/mp4\" | \"video/mp4\" ;\n *   };\n * };\n *\n * export type Message = {\n *   role: Role;\n *   content: string | Array<ImageContent | TextContent | FileContent>\n * };\n *\n * Supported parameters:\n * messages: Array<{\n *   role: 'system' | 'user' | 'assistant' | 'tool',\n *   content: string | { tool_call: { name: string, arguments: string } }\n * }>\n * tool_choice?: 'none' | 'auto' | 'required' | { type: 'function', function: { name: string } }\n * tools?: Tool[]\n */\nconst response = await invokeLLM({\n  messages: [\n    { role: \"system\", content: \"You are a helpful assistant.\" },\n    { role: \"user\", content: \"Hello, world!\" },\n  ],\n});\n```\n\nTips\n- Always call llm functions from server-side code (e.g., inside tRPC procedures), to avoid exposing your API key.\n- You don't need to manually set the model; the helper uses a sensible default.\n- LLM responses often contain markdown. Use `<Streamdown>{content}</Streamdown>` (imported from `streamdown`) to render markdown content with proper formatting and streaming support.\n\n### Structured Responses (JSON Schema)\n\nAsk the model to return structured JSON via `response_format`:\n\n```ts\nimport { invokeLLM } from \"./server/_core/llm\";\n\nconst structured = await invokeLLM({\n  messages: [\n    { role: \"system\", content: \"You are a helpful assistant designed to output JSON.\" },\n    { role: \"user\", content: \"Extract the name and age from the following text: \\\"My name is Alice and I am 30 years old.\\\"\" },\n  ],\n  response_format: {\n    type: \"json_schema\",\n    json_schema: {\n      name: \"person_info\",\n      strict: true,\n      schema: {\n        type: \"object\",\n        properties: {\n          name: { type: \"string\", description: \"The name of the person\" },\n          age: { type: \"integer\", description: \"The age of the person\" },\n        },\n        required: [\"name\", \"age\"],\n        additionalProperties: false,\n      },\n    },\n  },\n});\n\n// The model responds with JSON content matching the schema.\n// Access via `structured.choices[0].message.content` and JSON.parse if needed.\n```\nThe helpers mirror the Python SDK semantics but produce JavaScript-first code, keeping credentials inside the server and ensuring every environment has access to the same token.\n\n---\n\n## Voice Transcription Integration\n\nUse the preconfigured voice transcription helper that converts speech to text using Whisper API, no manual setup required.\n\nExample usage:\n```ts\nimport { transcribeAudio } from \"./server/_core/voiceTranscription\";\n\nconst result = await transcribeAudio({\n  audioUrl: \"https://storage.example.com/audio/recording.mp3\",\n  language: \"en\", // Optional: helps improve accuracy\n  prompt: \"Transcribe meeting notes\" // Optional: context hint\n});\n\n// Returns native Whisper API response\n// result.text - Full transcription\n// result.language - Detected language (ISO-639-1)\n// result.segments - Timestamped segments with metadata\n```\n\nTips\n- Accepts URL to pre-uploaded audio file\n- 16MB file size limit enforced during transcription, size flag to be set by frontend\n- Supported formats: webm, mp3, wav, ogg, m4a\n- Returns native Whisper API response with rich metadata\n- Frontend should handle audio capture, storage upload, and size validation\n\n---\n\n## Image Generation Integration\n\nUse the preconfigured image generation helper that connects to the internal ImageService, no manual setup required.\n\nExample usage:\n```ts\nimport { generateImage } from \"./server/_core/imageGeneration.ts\";\n\nconst { url: imageUrl } = await generateImage({\n  prompt: \"A serene landscape with mountains\"\n});\n// For editing:\nconst { url: imageUrl } = await generateImage({\n  prompt: \"Add a rainbow to this landscape\",\n  originalImages: [{\n    url: \"https://example.com/original.jpg\",\n    mimeType: \"image/jpeg\"\n  }]\n});\n```\n\nTips\n- Always call from server-side code (e.g., inside tRPC procedures) to avoid exposing API keys\n- Image generation can take 5-20 seconds, implement proper loading states\n- Implement proper error handling as image generation can fail\n\n---\n\n## ‚òÅÔ∏è File Storage\n\nUse the preconfigured S3 helpers in `server/storage.ts`. Credentials are injected from the platform (no manual setup required).\n\n```ts\nimport { storagePut } from \"./server/storage\";\n\n// Upload bytes to S3 with non-enumerable path\n// The S3 bucket is public, so returned URLs work without additional signing process\n// Add random suffixes to file keys to prevent enumeration\nconst fileKey = `${userId}-files/${fileName}-${randomSuffix()}.png`\nconst { url } = await storagePut(\n  fileKey,\n  fileBuffer, // Buffer | Uint8Array | string\n  \"image/png\"\n);\n```\n\nTips\n- Save metadata (path/URL/ACL/owner/mime/size) in your database; use S3 for the actual file bytes. This applies to all files including images, documents, and media.\n- For file uploads, have the client POST to your server, then call `storagePut` from your backend.\n\n---\n\n## üó∫Ô∏è Maps Integration\n\n**CRITICAL: The Manus proxy provides FULL access to ALL Google Maps features** - including advanced drawing, heatmaps, Street View, all layers, Places API, etc. Do ask users for Google Map API keys - authentication is automatic.\n\n**Default: Use Frontend SDK** - Import MapView from `client/src/components/Map.tsx` and initialize ANY Google Maps service (geocoding, directions, places, drawing, visualization, geometry, etc.) in the onMapReady callback. \n\n**Use Backend API only when:**\n- Persisting data (save routes/locations to database)\n- Bulk operations (1000+ addresses)\n- Server-side needs (caching, scheduled jobs, hiding business logic)\n\n**Implementation:**\n- Frontend: See `client/src/components/Map.tsx` for component usage - ALL Google Maps JavaScript API features work\n- Backend: Create tRPC procedures using `makeRequest` from `server/_core/map.ts`\n\nNEVER use external map libraries or request API keys from users - the Manus proxy handles everything automatically with no feature limitations.\n\n\n---\n\n## ‚òÅÔ∏è Data API\n\nWhen you need external data, use the omni_search with search_type = 'api' to see there's any built-in api available in Manus API Hub access. You only have to connect other api if there's no suitable built-in api available.\n\n---\n\n## Owner Notifications\n\nThis template already ships with a `notifyOwner({ title, content })` helper (`server/_core/notification.ts`) and a protected tRPC mutation at `trpc.system.notifyOwner`. Use it whenever backend logic needs to push an operational update to the Manus project owner‚Äîcommon triggers are new form submissions, survey feedback, or workflow results.\n\n1. On the server, call `await notifyOwner({ title, content })` or reuse the provided `system.notifyOwner` mutation from jobs/webhooks (`trpc.system.notifyOwner.useMutation()` on the client).\n2. Handle the boolean return (`true` on success, `false` if the upstream service is temporarily unavailable) to decide whether you need a fallback channel.\n\nKeep this channel for owner-facing alerts; end-user messaging should flow through your app-specific systems.\n\n---\n\n## ‚è± Datetime & Timezone\n\nPersistence: Store all business timestamps as UTC-based Unix timestamps (milliseconds since epoch) at the database and API layer. Do not store client-local, timezone-dependent, or string-based timestamps unless explicitly required as separate fields.\nFrontend display: In React components, always convert UTC timestamps to the user‚Äôs local timezone for display e.g. new Date(utcTimestamp).toLocaleString(). Keep all internal state and API interactions in UTC timestamps to avoid drift and confusion.\n\n---\n\n## Tips\n\n- Keep router files under ~150 lines‚Äîsplit into `server/routers/<feature>.ts` once they grow.\n- Show loading states at component level (spinners, skeletons) rather than blocking entire pages‚Äîkeeps the app feeling responsive.\n\n---\n\n## Core File References\n\nNote: All TODO comments are remarks for the agent (you), not for the user.\n\n`package.json`\n```ts\n{\n  \"name\": \"{{project_name}}\",\n  \"version\": \"1.0.0\",\n  \"type\": \"module\",\n  \"license\": \"MIT\",\n  \"scripts\": {\n    \"dev\": \"NODE_ENV=development tsx watch server/_core/index.ts\",\n    \"build\": \"vite build && esbuild server/_core/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist\",\n    \"start\": \"NODE_ENV=production node dist/index.js\",\n    \"check\": \"tsc --noEmit\",\n    \"format\": \"prettier --write .\",\n    \"test\": \"vitest run\",\n    \"db:push\": \"drizzle-kit generate && drizzle-kit migrate\"\n  },\n  \"dependencies\": {\n    \"@aws-sdk/client-s3\": \"^3.693.0\",\n    \"@aws-sdk/s3-request-presigner\": \"^3.693.0\",\n    \"@hookform/resolvers\": \"^5.2.2\",\n    \"@radix-ui/react-accordion\": \"^1.2.12\",\n    \"@radix-ui/react-alert-dialog\": \"^1.1.15\",\n    \"@radix-ui/react-aspect-ratio\": \"^1.1.7\",\n    \"@radix-ui/react-avatar\": \"^1.1.10\",\n    \"@radix-ui/react-checkbox\": \"^1.3.3\",\n    \"@radix-ui/react-collapsible\": \"^1.1.12\",\n    \"@radix-ui/react-context-menu\": \"^2.2.16\",\n    \"@radix-ui/react-dialog\": \"^1.1.15\",\n    \"@radix-ui/react-dropdown-menu\": \"^2.1.16\",\n    \"@radix-ui/react-hover-card\": \"^1.1.15\",\n    \"@radix-ui/react-label\": \"^2.1.7\",\n    \"@radix-ui/react-menubar\": \"^1.1.16\",\n    \"@radix-ui/react-navigation-menu\": \"^1.2.14\",\n    \"@radix-ui/react-popover\": \"^1.1.15\",\n    \"@radix-ui/react-progress\": \"^1.1.7\",\n    \"@radix-ui/react-radio-group\": \"^1.3.8\",\n    \"@radix-ui/react-scroll-area\": \"^1.2.10\",\n    \"@radix-ui/react-select\": \"^2.2.6\",\n    \"@radix-ui/react-separator\": \"^1.1.7\",\n    \"@radix-ui/react-slider\": \"^1.3.6\",\n    \"@radix-ui/react-slot\": \"^1.2.3\",\n    \"@radix-ui/react-switch\": \"^1.2.6\",\n    \"@radix-ui/react-tabs\": \"^1.1.13\",\n    \"@radix-ui/react-toggle\": \"^1.1.10\",\n    \"@radix-ui/react-toggle-group\": \"^1.1.11\",\n    \"@radix-ui/react-tooltip\": \"^1.2.8\",\n    \"@tanstack/react-query\": \"^5.90.2\",\n    \"@trpc/client\": \"^11.6.0\",\n    \"@trpc/react-query\": \"^11.6.0\",\n    \"@trpc/server\": \"^11.6.0\",\n    \"axios\": \"^1.12.0\",\n    \"class-variance-authority\": \"^0.7.1\",\n    \"clsx\": \"^2.1.1\",\n    \"cmdk\": \"^1.1.1\",\n    \"cookie\": \"^1.0.2\",\n    \"date-fns\": \"^4.1.0\",\n    \"dotenv\": \"^17.2.2\",\n    \"drizzle-orm\": \"^0.44.5\",\n    \"embla-carousel-react\": \"^8.6.0\",\n    \"express\": \"^4.21.2\",\n    \"framer-motion\": \"^12.23.22\",\n    \"input-otp\": \"^1.4.2\",\n    \"jose\": \"6.1.0\",\n    \"lucide-react\": \"^0.453.0\",\n    \"mysql2\": \"^3.15.0\",\n    \"nanoid\": \"^5.1.5\",\n    \"next-themes\": \"^0.4.6\",\n    \"react\": \"^19.2.1\",\n    \"react-day-picker\": \"^9.11.1\",\n    \"react-dom\": \"^19.2.1\",\n    \"react-hook-form\": \"^7.64.0\",\n    \"react-resizable-panels\": \"^3.0.6\",\n    \"recharts\": \"^2.15.2\",\n    \"sonner\": \"^2.0.7\",\n    \"streamdown\": \"^1.4.0\",\n    \"superjson\": \"^1.13.3\",\n    \"tailwind-merge\": \"^3.3.1\",\n    \"tailwindcss-animate\": \"^1.0.7\",\n    \"vaul\": \"^1.1.2\",\n    \"wouter\": \"^3.3.5\",\n    \"zod\": \"^4.1.12\"\n  },\n  \"devDependencies\": {\n    \"@builder.io/vite-plugin-jsx-loc\": \"^0.1.1\",\n    \"@tailwindcss/typography\": \"^0.5.15\",\n    \"@tailwindcss/vite\": \"^4.1.3\",\n    \"@types/express\": \"4.17.21\",\n    \"@types/google.maps\": \"^3.58.1\",\n    \"@types/node\": \"^24.7.0\",\n    \"@types/react\": \"^19.2.1\",\n    \"@types/react-dom\": \"^19.2.1\",\n    \"@vitejs/plugin-react\": \"^5.0.4\",\n    \"add\": \"^2.0.6\",\n    \"autoprefixer\": \"^10.4.20\",\n    \"drizzle-kit\": \"^0.31.4\",\n    \"esbuild\": \"^0.25.0\",\n    \"pnpm\": \"^10.15.1\",\n    \"postcss\": \"^8.4.47\",\n    \"prettier\": \"^3.6.2\",\n    \"tailwindcss\": \"^4.1.14\",\n    \"tsx\": \"^4.19.1\",\n    \"tw-animate-css\": \"^1.4.0\",\n    \"typescript\": \"5.9.3\",\n    \"vite\": \"^7.1.7\",\n    \"vite-plugin-manus-runtime\": \"^0.0.57\",\n    \"vitest\": \"^2.1.4\"\n  },\n  \"packageManager\": \"pnpm@10.4.1+sha512.c753b6c3ad7afa13af388fa6d808035a008e30ea9993f58c6663e2bc5ff21679aa834db094987129aa4d488b86df57f7b634981b2f827cdcacc698cc0cfb88af\",\n  \"pnpm\": {\n    \"patchedDependencies\": {\n      \"wouter@3.7.1\": \"patches/wouter@3.7.1.patch\"\n    },\n    \"overrides\": {\n      \"tailwindcss>nanoid\": \"3.3.7\"\n    }\n  }\n}\n```\n\n`drizzle/schema.ts`\n```ts\nimport { int, mysqlEnum, mysqlTable, text, timestamp, varchar } from \"drizzle-orm/mysql-core\";\n\n/**\n * Core user table backing auth flow.\n * Extend this file with additional tables as your product grows.\n * Columns use camelCase to match both database fields and generated types.\n */\nexport const users = mysqlTable(\"users\", {\n  /**\n   * Surrogate primary key. Auto-incremented numeric value managed by the database.\n   * Use this for relations between tables.\n   */\n  id: int(\"id\").autoincrement().primaryKey(),\n  /** Manus OAuth identifier (openId) returned from the OAuth callback. Unique per user. */\n  openId: varchar(\"openId\", { length: 64 }).notNull().unique(),\n  name: text(\"name\"),\n  email: varchar(\"email\", { length: 320 }),\n  loginMethod: varchar(\"loginMethod\", { length: 64 }),\n  role: mysqlEnum(\"role\", [\"user\", \"admin\"]).default(\"user\").notNull(),\n  createdAt: timestamp(\"createdAt\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updatedAt\").defaultNow().onUpdateNow().notNull(),\n  lastSignedIn: timestamp(\"lastSignedIn\").defaultNow().notNull(),\n});\n\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = typeof users.$inferInsert;\n\n// TODO: Add your tables here\n```\n\n`server/db.ts`\n```ts\nimport { eq } from \"drizzle-orm\";\nimport { drizzle } from \"drizzle-orm/mysql2\";\nimport { InsertUser, users } from \"../drizzle/schema\";\nimport { ENV } from './_core/env';\n\nlet _db: ReturnType<typeof drizzle> | null = null;\n\n// Lazily create the drizzle instance so local tooling can run without a DB.\nexport async function getDb() {\n  if (!_db && process.env.DATABASE_URL) {\n    try {\n      _db = drizzle(process.env.DATABASE_URL);\n    } catch (error) {\n      console.warn(\"[Database] Failed to connect:\", error);\n      _db = null;\n    }\n  }\n  return _db;\n}\n\nexport async function upsertUser(user: InsertUser): Promise<void> {\n  if (!user.openId) {\n    throw new Error(\"User openId is required for upsert\");\n  }\n\n  const db = await getDb();\n  if (!db) {\n    console.warn(\"[Database] Cannot upsert user: database not available\");\n    return;\n  }\n\n  try {\n    const values: InsertUser = {\n      openId: user.openId,\n    };\n    const updateSet: Record<string, unknown> = {};\n\n    const textFields = [\"name\", \"email\", \"loginMethod\"] as const;\n    type TextField = (typeof textFields)[number];\n\n    const assignNullable = (field: TextField) => {\n      const value = user[field];\n      if (value === undefined) return;\n      const normalized = value ?? null;\n      values[field] = normalized;\n      updateSet[field] = normalized;\n    };\n\n    textFields.forEach(assignNullable);\n\n    if (user.lastSignedIn !== undefined) {\n      values.lastSignedIn = user.lastSignedIn;\n      updateSet.lastSignedIn = user.lastSignedIn;\n    }\n    if (user.role !== undefined) {\n      values.role = user.role;\n      updateSet.role = user.role;\n    } else if (user.openId === ENV.ownerOpenId) {\n      values.role = 'admin';\n      updateSet.role = 'admin';\n    }\n\n    if (!values.lastSignedIn) {\n      values.lastSignedIn = new Date();\n    }\n\n    if (Object.keys(updateSet).length === 0) {\n      updateSet.lastSignedIn = new Date();\n    }\n\n    await db.insert(users).values(values).onDuplicateKeyUpdate({\n      set: updateSet,\n    });\n  } catch (error) {\n    console.error(\"[Database] Failed to upsert user:\", error);\n    throw error;\n  }\n}\n\nexport async function getUserByOpenId(openId: string) {\n  const db = await getDb();\n  if (!db) {\n    console.warn(\"[Database] Cannot get user: database not available\");\n    return undefined;\n  }\n\n  const result = await db.select().from(users).where(eq(users.openId, openId)).limit(1);\n\n  return result.length > 0 ? result[0] : undefined;\n}\n\n// TODO: add feature queries here as your schema grows.\n```\n\n`server/routers.ts`\n```ts\nimport { COOKIE_NAME } from \"@shared/const\";\nimport { getSessionCookieOptions } from \"./_core/cookies\";\nimport { systemRouter } from \"./_core/systemRouter\";\nimport { publicProcedure, router } from \"./_core/trpc\";\n\nexport const appRouter = router({\n    // if you need to use socket.io, read and register route in server/_core/index.ts, all api should start with '/api/' so that the gateway can route correctly\n  system: systemRouter,\n  auth: router({\n    me: publicProcedure.query(opts => opts.ctx.user),\n    logout: publicProcedure.mutation(({ ctx }) => {\n      const cookieOptions = getSessionCookieOptions(ctx.req);\n      ctx.res.clearCookie(COOKIE_NAME, { ...cookieOptions, maxAge: -1 });\n      return {\n        success: true,\n      } as const;\n    }),\n  }),\n\n  // TODO: add feature routers here, e.g.\n  // todo: router({\n  //   list: protectedProcedure.query(({ ctx }) =>\n  //     db.getUserTodos(ctx.user.id)\n  //   ),\n  // }),\n});\n\nexport type AppRouter = typeof appRouter;\n```\n\n`client/src/App.tsx`\n```tsx\nimport { Toaster } from \"@/components/ui/sonner\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport NotFound from \"@/pages/NotFound\";\nimport { Route, Switch } from \"wouter\";\nimport ErrorBoundary from \"./components/ErrorBoundary\";\nimport { ThemeProvider } from \"./contexts/ThemeContext\";\nimport Home from \"./pages/Home\";\n\nfunction Router() {\n  // make sure to consider if you need authentication for certain routes\n  return (\n    <Switch>\n      <Route path={\"/\"} component={Home} />\n      <Route path={\"/404\"} component={NotFound} />\n      {/* Final fallback route */}\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\n// NOTE: About Theme\n// - First choose a default theme according to your design style (dark or light bg), than change color palette in index.css\n//   to keep consistent foreground/background color across components\n// - If you want to make theme switchable, pass `switchable` ThemeProvider and use `useTheme` hook\n\nfunction App() {\n  return (\n    <ErrorBoundary>\n      <ThemeProvider\n        defaultTheme=\"light\"\n        // switchable\n      >\n        <TooltipProvider>\n          <Toaster />\n          <Router />\n        </TooltipProvider>\n      </ThemeProvider>\n    </ErrorBoundary>\n  );\n}\n\nexport default App;\n```\n\n`client/src/lib/trpc.ts`\n```ts\nimport { createTRPCReact } from \"@trpc/react-query\";\nimport type { AppRouter } from \"../../../server/routers\";\n\nexport const trpc = createTRPCReact<AppRouter>();\n```\n\n`client/src/pages/Home.tsx`\n```tsx\nimport { useAuth } from \"@/_core/hooks/useAuth\";\nimport { Button } from \"@/components/ui/button\";\nimport { Loader2 } from \"lucide-react\";\nimport { getLoginUrl } from \"@/const\";\nimport { Streamdown } from 'streamdown';\n\n/**\n * All content in this page are only for example, replace with your own feature implementation\n * When building pages, remember your instructions in Frontend Workflow, Frontend Best Practices, Design Guide and Common Pitfalls\n */\nexport default function Home() {\n  // The userAuth hooks provides authentication state\n  // To implement login/logout functionality, simply call logout() or redirect to getLoginUrl()\n  let { user, loading, error, isAuthenticated, logout } = useAuth();\n\n  // If theme is switchable in App.tsx, we can implement theme toggling like this:\n  // const { theme, toggleTheme } = useTheme();\n\n  return (\n    <div className=\"min-h-screen flex flex-col\">\n      <main>\n        {/* Example: lucide-react for icons */}\n        <Loader2 className=\"animate-spin\" />\n        Example Page\n        {/* Example: Streamdown for markdown rendering */}\n        <Streamdown>Any **markdown** content</Streamdown>\n        <Button variant=\"default\">Example Button</Button>\n      </main>\n    </div>\n  );\n}\n```\n\n`server/auth.logout.test.ts`\n```ts\nimport { describe, expect, it } from \"vitest\";\nimport { appRouter } from \"./routers\";\nimport { COOKIE_NAME } from \"../shared/const\";\nimport type { TrpcContext } from \"./_core/context\";\n\ntype CookieCall = {\n  name: string;\n  options: Record<string, unknown>;\n};\n\ntype AuthenticatedUser = NonNullable<TrpcContext[\"user\"]>;\n\nfunction createAuthContext(): { ctx: TrpcContext; clearedCookies: CookieCall[] } {\n  const clearedCookies: CookieCall[] = [];\n\n  const user: AuthenticatedUser = {\n    id: 1,\n    openId: \"sample-user\",\n    email: \"sample@example.com\",\n    name: \"Sample User\",\n    loginMethod: \"manus\",\n    role: \"user\",\n    createdAt: new Date(),\n    updatedAt: new Date(),\n    lastSignedIn: new Date(),\n  };\n\n  const ctx: TrpcContext = {\n    user,\n    req: {\n      protocol: \"https\",\n      headers: {},\n    } as TrpcContext[\"req\"],\n    res: {\n      clearCookie: (name: string, options: Record<string, unknown>) => {\n        clearedCookies.push({ name, options });\n      },\n    } as TrpcContext[\"res\"],\n  };\n\n  return { ctx, clearedCookies };\n}\n\ndescribe(\"auth.logout\", () => {\n  it(\"clears the session cookie and reports success\", async () => {\n    const { ctx, clearedCookies } = createAuthContext();\n    const caller = appRouter.createCaller(ctx);\n\n    const result = await caller.auth.logout();\n\n    expect(result).toEqual({ success: true });\n    expect(clearedCookies).toHaveLength(1);\n    expect(clearedCookies[0]?.name).toBe(COOKIE_NAME);\n    expect(clearedCookies[0]?.options).toMatchObject({\n      maxAge: -1,\n      secure: true,\n      sameSite: \"none\",\n      httpOnly: true,\n      path: \"/\",\n    });\n  });\n});\n```\n---\n\n## Common Pitfalls\n\n### Infinite loading loops from unstable references\n**Anti-pattern:** Creating new objects/arrays in render that are used as query inputs\n```tsx\n// ‚ùå Bad: New Date() creates new reference every render ‚Üí infinite queries\nconst { data } = trpc.items.getByDate.useQuery({\n  date: new Date(), // ‚Üê New object every render!\n});\n\n// ‚ùå Bad: Array/object literals in query input\nconst { data } = trpc.items.getByIds.useQuery({\n  ids: [1, 2, 3], // ‚Üê New array reference every render!\n});\n```\n\n**Correct approach:** Stabilize references with useState/useMemo\n```tsx\n// ‚úÖ Good: Initialize once with useState\nconst [date] = useState(() => new Date());\nconst { data } = trpc.items.getByDate.useQuery({ date });\n\n// ‚úÖ Good: Memoize complex inputs\nconst ids = useMemo(() => [1, 2, 3], []);\nconst { data } = trpc.items.getByIds.useQuery({ ids });\n```\n\n**Why this happens:** TRPC queries trigger when input references change. Objects/arrays created in render have new references each time, causing infinite re-fetches.\n\n### Storing file bytes in database columns\n**Anti-pattern:** Adding BLOB/BYTEA columns to store file content\n```ts\n// ‚ùå Bad: Database bloat and slow queries\nexport const files = sqliteTable('files', {\n  content: blob('content'), // Never store file bytes\n});\n```\n\n**Correct approach:** Store S3 reference only, upload file bytes to S3\n```ts\n// ‚úÖ Good: Store metadata + S3 reference\nexport const files = sqliteTable('files', {\n  url: text('url').notNull(), // Url to reference the file in s3\n  fileKey: text('file_key').notNull(), // also save file_key for clarity\n  // optional, save other metadata if needed\n  // filename: text('filename'),\n  // mimeType: text('mime_type'),\n});\n```\n\nUse `storagePut()` to upload files (see S3 File Storage section).\n\n### Navigation dead-ends in subpages\n**Problem:** Creating nested routes without escape routes‚Äîno header nav, no sidebar, no back button.\n\n**Root cause:** Implementing individual pages before establishing global layout structure.\n\n**Solution:** Define layout wrapper in App.tsx first, then build pages inside it. For admin tools use DashboardLayout; for detail pages add back button with `router.back()`.\n\n### Invisible text from theme/color mismatches\n\n**Root cause:** Semantic colors (`bg-background`, `text-foreground`) are CSS variables that resolve based on ThemeProvider's active theme. Mismatches cause invisible text.\n\n**Two critical rules:**\n\n1. **Match theme to CSS variables:** If `defaultTheme=\"dark\"` in App.tsx, ensure `.dark {}` in index.css has dark background + light foreground values\n2. **Always pair bg with text:** When using `bg-{semantic}`, MUST also use `text-{semantic}-foreground` (not automatic - text inherits from parent otherwise)\n\n**Quick reference:**\n```tsx\n// ‚úÖ Theme + CSS alignment\n<ThemeProvider defaultTheme=\"dark\">  {/* Must match .dark in index.css */}\n  <div className=\"bg-background text-foreground\">...</div>\n</ThemeProvider>\n\n// ‚úÖ Required class pairs\n<div className=\"bg-popover text-popover-foreground\">...</div>\n<div className=\"bg-card text-card-foreground\">...</div>\n<div className=\"bg-accent text-accent-foreground\">...</div>\n```\n\n### Nested anchor tags in Link components\n**Problem:** Wrapping `<a>` tags inside another `<a>` or wouter's `<Link>` creates nested anchors and runtime errors.\n\n**Solution:** Pass children directly to Link‚Äîit already renders an `<a>` internally.\n```tsx\n// ‚ùå Bad: <Link><a>...</a></Link> or <a><a>...</a></a>\n// ‚úÖ Good: <Link>...</Link> or just <a>...</a>\n```\n\n### Empty `Select.Item` values\n**Rule:** Every `<Select.Item>` must have a non-empty `value` prop‚Äînever `\"\"`, `undefined`, or omitted.",
  "app": "# Expo Mobile Template\n\nReact Native mobile app with **Expo SDK 54**, **TypeScript**, and **React 19**.\n\n**Tech Stack:** React Native 0.81 | Expo Router 6 | NativeWind 4 (Tailwind CSS) | TypeScript 5.9 | react-native-reanimated 4.x\n\n---\n\n## Quick Start\n\n1. **Edit the home screen** ‚Äî `app/(tabs)/index.tsx` is your app's main entry point\n2. **Customize theme** ‚Äî Update tokens in `theme.config.js` (used by Tailwind + runtime) and app details in `app.config.ts`\n3. **Add new screens** ‚Äî Use `ScreenContainer` component for proper SafeArea handling\n4. **Add tab icons** ‚Äî Map icons in `icon-symbol.tsx` BEFORE using in tabs\n\n---\n\n## Project Structure\n\n```\napp/\n  _layout.tsx        ‚Üê Root layout with providers\n  (tabs)/\n    _layout.tsx      ‚Üê Tab bar configuration\n    index.tsx        ‚Üê Home screen (EDIT THIS FIRST)\n  oauth/             ‚Üê Auth callback (don't modify)\ncomponents/\n  screen-container.tsx ‚Üê SafeArea wrapper (USE FOR ALL SCREENS)\n  themed-view.tsx    ‚Üê View with auto theme background\n  ui/\n    icon-symbol.tsx  ‚Üê Tab bar icon mapping (ADD ICONS HERE FIRST)\nconstants/\n  theme.ts           ‚Üê Runtime palette re-export (implemented in lib/_core/theme.ts)\ntheme.config.js      ‚Üê Single palette config (edit tokens here first)\ntheme.config.d.ts    ‚Üê Palette typings (update when adding new keys)\nlib/_core/theme.ts   ‚Üê Runtime palette builder (shared by Tailwind + useColors)\nlib/theme-provider.tsx ‚Üê Global theme context (light/dark switch)\nlib/_core/nativewind-pressable.ts ‚Üê Disables Pressable className to avoid NativeWind pitfalls\nhooks/\n  use-auth.ts        ‚Üê Auth state hook\n  use-colors.ts      ‚Üê Theme colors hook\n  use-color-scheme.ts ‚Üê Dark/light mode detection\nlib/\n  trpc.ts            ‚Üê API client\n  utils.ts           ‚Üê Utility functions (cn)\nglobal.css           ‚Üê Tailwind directives\ntailwind.config.js   ‚Üê Tailwind theme configuration\nassets/images/       ‚Üê App icons and splash\n```\n\n---\n\n## Styling with NativeWind (Tailwind CSS)\n\nThis template uses **NativeWind v4** for Tailwind CSS support in React Native.\n\n### Basic Usage\n\n```tsx\nimport { Text, View } from \"react-native\";\n\nexport function MyComponent() {\n  return (\n    <View className=\"flex-1 items-center justify-center p-4\">\n      <Text className=\"text-2xl font-bold text-foreground\">\n        Hello World\n      </Text>\n      <Text className=\"mt-2 text-muted\">\n        Subtitle text\n      </Text>\n    </View>\n  );\n}\n```\n\n### Available Colors (from `theme.config.js`)\n\nTokens are defined once in `theme.config.js` and shared by Tailwind + runtime (`useColors()`):\n\n| Token | Usage |\n|-------|-------|\n| `background` | Screen/page background |\n| `foreground` | Primary text |\n| `muted` | Secondary text |\n| `primary` | Accent/tint color |\n| `surface` | Cards/elevated surfaces |\n| `border` | Borders/dividers |\n| `success` | Success states |\n| `warning` | Warning states |\n| `error` | Error states |\n\n**Dark mode:** Use color tokens directly (e.g., `text-foreground`, `bg-background`); ThemeProvider + CSS variables switch schemes automatically, no `dark:` prefix needed.\n\n### Layout Tips\n- If content may overflow, wrap the whole page in a `ScrollView`; short lists inside can use `.map()`.\n- When multiple texts/icons must be inline, set parent `flex-row` (Pressable/TouchableOpacity default to column).\n- Pressable className is globally disabled; pass interaction styles via `style`.\n- For text inputs that submit on keyboard, set `returnKeyType=\"done\"` (and handle submit) to avoid ‚ÄúEnter does nothing‚Äù issues on mobile.\n\n### Combining Classes\n\nUse the `cn()` utility from `@/lib/utils`:\n\n```tsx\nimport { cn } from \"@/lib/utils\";\n\n<View className={cn(\n  \"p-4 rounded-lg\",\n  isActive && \"bg-primary\",\n  disabled && \"opacity-50\"\n)} />\n```\n\n---\n\n## State Management Guidance\n\n- Default: React Context + `useReducer`/`useState` (simpler, fewer pitfalls). Persist with `AsyncStorage`/`MMKV` if needed.\n- If you choose Zustand:\n  - Selectors must return stable references (no new objects/arrays inside selectors).\n  - Subscribe to data, not functions: `useStore((s) => s.state.entries)`; derive with `useMemo`.\n  - Why: unstable selectors cause stale renders or render loops.\n- For server data, prefer TanStack Query (already included).\n- Expo FileSystem (SDK 54+): default to `import * as FileSystem from \"expo-file-system/legacy\"` to avoid deprecation warnings. If you need the new API, use `import { File } from \"expo-file-system/next\"` and `await new File(uri).base64()`.\n- Provider wiring checklist: whenever you create a new context/provider, import it in `app/_layout.tsx` and wrap the app (outermost or alongside ThemeProvider) before calling any `useXxx` hook.\n\n## Data & API Guidance\n\n- Keep data flow consistent: define shared types/schemas and ensure sender/receiver param names match (e.g., route params, API payloads).\n- No mock/placeholder numbers in UI; if data is unavailable, show loading/unknown, not hardcoded values.\n- Platform-specific file handling: on iOS, `MediaLibrary.getAssetsAsync()` URIs (ph://) are not readable‚Äîuse `MediaLibrary.getAssetInfoAsync()` to get `localUri` before reading/uploading.\n- Validate end-to-end: API ‚Üí data transform ‚Üí navigation params ‚Üí UI render. Avoid stopping halfway. \n\n## Screen Layout\n\n### The Problem\n\nReact Native screens need to handle:\n- Status bar area (notch on iPhone X+)\n- Home indicator area (bottom of iPhone X+)\n- Tab bar overlap\n\n### The Solution: ScreenContainer\n\n**Always use `ScreenContainer` for screen content:**\n\n```tsx\nimport { Text } from \"react-native\";\nimport { ScreenContainer } from \"@/components/screen-container\";\n\nexport default function MyScreen() {\n  return (\n    <ScreenContainer className=\"p-4\">\n      <Text className=\"text-2xl font-bold text-foreground\">\n        Welcome\n      </Text>\n    </ScreenContainer>\n  );\n}\n```\n\n`ScreenContainer` handles:\n- Background color extends behind status bar\n- Content stays within safe bounds\n- Tab bar area handled correctly\n\n### ScreenContainer Props\n\n| Prop | Type | Default | Description |\n|------|------|---------|-------------|\n| `className` | string | - | Tailwind classes for content area |\n| `edges` | Edge[] | `[\"top\", \"left\", \"right\"]` | SafeArea edges to apply |\n| `containerClassName` | string | - | Classes for outer background container |\n\n```tsx\n// Full-screen modal (needs all edges)\n<ScreenContainer edges={[\"top\", \"bottom\", \"left\", \"right\"]}>\n\n// Screen with custom bottom handling\n<ScreenContainer edges={[\"top\", \"left\", \"right\"]}>\n```\n\n---\n\n## Interaction Design\n\n### Priority Order\n\nBuild in this order ‚Äî don't skip to polish before functionality works:\n\n1. **Functionality** ‚Äî All buttons work, all flows complete, no dead ends\n2. **Feedback** ‚Äî User knows their action was received (press states, loading indicators)\n3. **Polish** ‚Äî Animations and transitions (only if time permits)\n\n### Press Feedback\n\n| Element | Feedback | Implementation |\n|---------|----------|----------------|\n| Primary buttons | Scale + haptic | `scale: 0.97` + `Haptics.impactAsync(Light)` |\n| List items / cards | Opacity | `opacity: 0.7` on press |\n| Icons / minor actions | Opacity only | `opacity: 0.6` on press |\n\n```tsx\n<Pressable\n  onPress={handlePress}\n  style={({ pressed }) => [\n    styles.button,\n    pressed && { transform: [{ scale: 0.97 }], opacity: 0.9 }\n  ]}\n>\n```\n\n### Haptics\n\nUse `expo-haptics` sparingly ‚Äî overuse diminishes impact:\n\n| Context | Type |\n|---------|------|\n| Button tap (primary actions) | `impactAsync(ImpactFeedbackStyle.Light)` |\n| Toggle / switch | `impactAsync(ImpactFeedbackStyle.Medium)` |\n| Success / completion | `notificationAsync(NotificationFeedbackType.Success)` |\n| Error / failure | `notificationAsync(NotificationFeedbackType.Error)` |\n\n### Animation (Optional Polish)\n\nOnly add animations after core functionality works. Keep them subtle:\n\n```tsx\n// ‚úÖ Good: Subtle fade in\nwithTiming(1, { duration: 250 })\n\n// ‚úÖ Good: Gentle press feedback\nwithTiming(0.97, { duration: 80 })\n\n// ‚ùå Bad: Bouncy spring\nwithSpring(1, { damping: 5 })  // Too bouncy\n\n// ‚ùå Bad: Dramatic scale\nwithTiming(0.8, { duration: 200 })  // Too much\n```\n\n**Guidelines:**\n- Duration: 80-300ms for interactions, up to 400ms for transitions\n- Scale changes: 0.95-0.98 range (never below 0.9)\n- Prefer `withTiming` with easing over `withSpring`\n- Don't animate on mount unless it adds meaning\n\n---\n\n## Native Features\n\n### Audio (expo-audio)\n\n```tsx\nimport { useAudioPlayer, setAudioModeAsync } from \"expo-audio\";\n\n// IMPORTANT: Enable playback in iOS silent mode\nawait setAudioModeAsync({ playsInSilentModeIOS: true });\n\n// Always release player on cleanup\nuseEffect(() => {\n  return () => player.release();\n}, []);\n\n// Use real audio sources (no mock/generated placeholders). Track playback state internally for reliable UI:\n// type Track = { player: AudioPlayer; volume: number; loop: boolean; isPlaying: boolean };\n// track.player.play(); track.isPlaying = true; emit();\n// track.player.pause(); track.isPlaying = false; emit();\n// const isPlaying = track.isPlaying; // use for UI instead of player.playing (may lag on native)\n```\n\n**Getting Free Audio:** Use browser console on [pixabay.com/sound-effects](https://pixabay.com/sound-effects/):\n```javascript\n// 1) Open a sound page (or search results) on pixabay.com/sound-effects\n// 2) Paste this in browser DevTools console to list direct mp3 links\nconst urls = document.documentElement.innerHTML.match(/https?:\\/\\/[^\"'\\s]+\\.mp3[^\"'\\s]*/g) || [];\nconsole.log(urls);\n```\n\n### Keep Screen Awake (expo-keep-awake)\n\n```tsx\nimport { useKeepAwake } from \"expo-keep-awake\";\n\n// Screen stays on while component is mounted\n// Use for: meditation, workout, reading screens\nuseKeepAwake();\n```\n\n### Platform Detection\n\nDisable native-only features on web:\n\n```tsx\nimport { Platform } from \"react-native\";\n\nif (Platform.OS !== \"web\") {\n  Haptics.impactAsync(ImpactFeedbackStyle.Light);\n}\n```\n\n---\n\n## Project Conventions\n\n### Tab Icons\nAdd mapping in `icon-symbol.tsx` BEFORE using in tabs ‚Äî otherwise app crashes.\n\n### Data Storage\nPrefer `AsyncStorage` for local persistence. Only add backend for cross-device sync.\n\n### Lists\nAlways use `FlatList` ‚Äî never `ScrollView` with `.map()`.\n\n### Styles\nUse `StyleSheet.create()` outside component, or Tailwind classes. Never inline style objects.\n\n---\n\n## Common Pitfalls\n\n| Pitfall | Solution |\n|---------|----------|\n| Broken user flows / dead ends | Verify all flows end-to-end before delivery. Every `onPress` must work. |\n| Missing icon mapping | Add to `icon-symbol.tsx` BEFORE using in tabs |\n| Text clipped at top/bottom | Ensure `lineHeight > fontSize` (1.2-1.5√ó) |\n| Background gap in dark mode | Use `ScreenContainer` |\n| Content under notch | Use `ScreenContainer` |\n| Slow list scrolling | Use `FlatList`, never `ScrollView` with `.map()` |\n| Styles recreated every render | Use `StyleSheet.create()` outside component |\n| iOS crash in gesture callbacks | Gesture handlers run as worklets. Use `.runOnJS(true)` on the gesture, or wrap JS calls with `runOnJS()` |\n| Web crash with AnimatedSvg | Don't use `Animated.createAnimatedComponent(Svg)`. Wrap `<Svg>` with `<Animated.View>` instead |\n| Gesture not responding | Ensure `GestureHandlerRootView` wraps the app |\n| State changes not persisted | Call `saveSettings()` or `AsyncStorage.setItem()` after `setState()` |\n| Bottom elements hidden by Tab Bar | Use `useSafeAreaInsets().bottom` or increase `bottom` value |\n| **Pressable onPress not firing** | **Never use `className` on Pressable** ‚Äî always use `style` prop |\n\n### Common Crash Patterns\n\n- **iOS crash on gesture**: Check worklet/JS thread issues (see Common Pitfalls)\n- **Web white screen**: Check browser console for errors\n- **Android ANR**: Check for blocking operations on main thread\n\n---\n\n## Backend Capabilities\n\nThe server provides these **built-in** capabilities (no external API keys required):\n\n| Feature | What It Provides | When To Use |\n|---------|------------------|-------------|\n| **LLM/AI** | Multimodal AI (text, image, audio) | Image recognition, chat, content generation |\n| **User Auth** | OAuth login, session management | User accounts |\n| **Database** | PostgreSQL + Drizzle ORM | Cross-device data sync |\n| **File Storage** | S3-compatible storage | User-uploaded files |\n| **Push Notifications** | Server-side delivery | Notify users of events |\n\n> **Important**: For AI features, use the server's built-in LLM ‚Äî do NOT ask users for API keys.\n\nSee `server/README.md` for implementation details.\n\n---\n\n## Delivery Checklist\n\nBefore delivering:\n\n- [ ] All buttons and links work (no empty `onPress` handlers)\n- [ ] Core user flows tested end-to-end\n- [ ] `app/(tabs)/index.tsx` customized\n- [ ] `tailwind.config.js` colors match brand\n- [ ] `app.config.ts` app name updated\n- [ ] Icon mappings added in `icon-symbol.tsx`\n- [ ] No console errors on iOS, Android, and Web\n\n---\n\n## Core File References\n\nNote: All TODO comments are remarks for the agent (you), not for the user.\n\n`components/screen-container.tsx`\n```tsx\nimport { View, type ViewProps } from \"react-native\";\nimport { SafeAreaView, type Edge } from \"react-native-safe-area-context\";\n\nimport { cn } from \"@/lib/utils\";\n\nexport interface ScreenContainerProps extends ViewProps {\n  /**\n   * SafeArea edges to apply. Defaults to [\"top\", \"left\", \"right\"].\n   * Bottom is typically handled by Tab Bar.\n   */\n  edges?: Edge[];\n  /**\n   * Tailwind className for the content area.\n   */\n  className?: string;\n  /**\n   * Additional className for the outer container (background layer).\n   */\n  containerClassName?: string;\n  /**\n   * Additional className for the SafeAreaView (content layer).\n   */\n  safeAreaClassName?: string;\n}\n\n/**\n * A container component that properly handles SafeArea and background colors.\n *\n * The outer View extends to full screen (including status bar area) with the background color,\n * while the inner SafeAreaView ensures content is within safe bounds.\n *\n * Usage:\n * ```tsx\n * <ScreenContainer className=\"p-4\">\n *   <Text className=\"text-2xl font-bold text-foreground\">\n *     Welcome\n *   </Text>\n * </ScreenContainer>\n * ```\n */\nexport function ScreenContainer({\n  children,\n  edges = [\"top\", \"left\", \"right\"],\n  className,\n  containerClassName,\n  safeAreaClassName,\n  style,\n  ...props\n}: ScreenContainerProps) {\n  return (\n    <View\n      className={cn(\n        \"flex-1\",\n        \"bg-background\",\n        containerClassName\n      )}\n      {...props}\n    >\n      <SafeAreaView\n        edges={edges}\n        className={cn(\"flex-1\", safeAreaClassName)}\n        style={style}\n      >\n        <View className={cn(\"flex-1\", className)}>{children}</View>\n      </SafeAreaView>\n    </View>\n  );\n}\n```\n\n`app/(tabs)/_layout.tsx`\n```tsx\nimport { Tabs } from \"expo-router\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\n\nimport { HapticTab } from \"@/components/haptic-tab\";\nimport { IconSymbol } from \"@/components/ui/icon-symbol\";\nimport { Platform } from \"react-native\";\nimport { useColors } from \"@/hooks/use-colors\";\n\nexport default function TabLayout() {\n  const colors = useColors();\n  const insets = useSafeAreaInsets();\n  const bottomPadding = Platform.OS === \"web\" ? 12 : Math.max(insets.bottom, 8);\n  const tabBarHeight = 56 + bottomPadding;\n\n  return (\n    <Tabs\n      screenOptions={{\n        tabBarActiveTintColor: colors.tint,\n        headerShown: false,\n        tabBarButton: HapticTab,\n        tabBarStyle: {\n          paddingTop: 8,\n          paddingBottom: bottomPadding,\n          height: tabBarHeight,\n          backgroundColor: colors.background,\n          borderTopColor: colors.border,\n          borderTopWidth: 0.5,\n        },\n      }}\n    >\n      <Tabs.Screen\n        name=\"index\"\n        options={{\n          title: \"Home\",\n          tabBarIcon: ({ color }) => <IconSymbol size={28} name=\"house.fill\" color={color} />,\n        }}\n      />\n    </Tabs>\n  );\n}\n```\n\n`app/(tabs)/index.tsx`\n```tsx\nimport { ScrollView, Text, View, TouchableOpacity } from \"react-native\";\n\nimport { ScreenContainer } from \"@/components/screen-container\";\n\n/**\n * Home Screen - NativeWind Example\n *\n * This template uses NativeWind (Tailwind CSS for React Native).\n * You can use familiar Tailwind classes directly in className props.\n *\n * Key patterns:\n * - Use `className` instead of `style` for most styling\n * - Theme colors: use tokens directly (bg-background, text-foreground, bg-primary, etc.); no dark: prefix needed\n * - Responsive: standard Tailwind breakpoints work on web\n * - Custom colors defined in tailwind.config.js\n */\nexport default function HomeScreen() {\n  return (\n    <ScreenContainer className=\"p-6\">\n      <ScrollView contentContainerStyle={{ flexGrow: 1 }}>\n        <View className=\"flex-1 gap-8\">\n          {/* Hero Section */}\n          <View className=\"items-center gap-2\">\n            <Text className=\"text-4xl font-bold text-foreground\">Welcome</Text>\n            <Text className=\"text-base text-muted text-center\">\n              Edit app/(tabs)/index.tsx to get started\n            </Text>\n          </View>\n\n          {/* Example Card */}\n          <View className=\"w-full max-w-sm self-center bg-surface rounded-2xl p-6 shadow-sm border border-border\">\n            <Text className=\"text-lg font-semibold text-foreground mb-2\">NativeWind Ready</Text>\n            <Text className=\"text-sm text-muted leading-relaxed\">\n              Use Tailwind CSS classes directly in your React Native components.\n            </Text>\n          </View>\n\n          {/* Example Button */}\n          <View className=\"items-center\">\n            <TouchableOpacity className=\"bg-primary px-6 py-3 rounded-full active:opacity-80\">\n              <Text className=\"text-background font-semibold\">Get Started</Text>\n            </TouchableOpacity>\n          </View>\n        </View>\n      </ScrollView>\n    </ScreenContainer>\n  );\n}\n```\n\n`lib/utils.ts`\n```ts\nimport { clsx, type ClassValue } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n\n/**\n * Combines class names using clsx and tailwind-merge.\n * This ensures Tailwind classes are properly merged without conflicts.\n *\n * Usage:\n * ```tsx\n * cn(\"px-4 py-2\", isActive && \"bg-primary\", className)\n * ```\n */\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n```\n\n`hooks/use-colors.ts`\n```tsx\nimport { Colors, type ColorScheme, type ThemeColorPalette } from \"@/constants/theme\";\nimport { useColorScheme } from \"./use-color-scheme\";\n\n/**\n * Returns the current theme's color palette.\n * Usage: const colors = useColors(); then colors.text, colors.background, etc.\n */\nexport function useColors(colorSchemeOverride?: ColorScheme): ThemeColorPalette {\n  const colorSchema = useColorScheme();\n  const scheme = (colorSchemeOverride ?? colorSchema ?? \"light\") as ColorScheme;\n  return Colors[scheme];\n}\n```\n\n`components/ui/icon-symbol.tsx`\n```tsx\n// Fallback for using MaterialIcons on Android and web.\n\nimport MaterialIcons from \"@expo/vector-icons/MaterialIcons\";\nimport { SymbolWeight, SymbolViewProps } from \"expo-symbols\";\nimport { ComponentProps } from \"react\";\nimport { OpaqueColorValue, type StyleProp, type TextStyle } from \"react-native\";\n\ntype IconMapping = Record<SymbolViewProps[\"name\"], ComponentProps<typeof MaterialIcons>[\"name\"]>;\ntype IconSymbolName = keyof typeof MAPPING;\n\n/**\n * Add your SF Symbols to Material Icons mappings here.\n * - see Material Icons in the [Icons Directory](https://icons.expo.fyi).\n * - see SF Symbols in the [SF Symbols](https://developer.apple.com/sf-symbols/) app.\n */\nconst MAPPING = {\n  \"house.fill\": \"home\",\n  \"paperplane.fill\": \"send\",\n  \"chevron.left.forwardslash.chevron.right\": \"code\",\n  \"chevron.right\": \"chevron-right\",\n} as IconMapping;\n\n/**\n * An icon component that uses native SF Symbols on iOS, and Material Icons on Android and web.\n * This ensures a consistent look across platforms, and optimal resource usage.\n * Icon `name`s are based on SF Symbols and require manual mapping to Material Icons.\n */\nexport function IconSymbol({\n  name,\n  size = 24,\n  color,\n  style,\n}: {\n  name: IconSymbolName;\n  size?: number;\n  color: string | OpaqueColorValue;\n  style?: StyleProp<TextStyle>;\n  weight?: SymbolWeight;\n}) {\n  return <MaterialIcons color={color} size={size} name={MAPPING[name]} style={style} />;\n}\n```\n\n`tailwind.config.js`\n```js\nconst { themeColors } = require(\"./theme.config\");\nconst plugin = require(\"tailwindcss/plugin\");\n\nconst tailwindColors = Object.fromEntries(\n  Object.entries(themeColors).map(([name, swatch]) => [\n    name,\n    {\n      DEFAULT: `var(--color-${name})`,\n      light: swatch.light,\n      dark: swatch.dark,\n    },\n  ]),\n);\n\n/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  darkMode: \"class\",\n  // Scan all component and app files for Tailwind classes\n  content: [\"./app/**/*.{js,ts,tsx}\", \"./components/**/*.{js,ts,tsx}\", \"./lib/**/*.{js,ts,tsx}\", \"./hooks/**/*.{js,ts,tsx}\"],\n\n  presets: [require(\"nativewind/preset\")],\n  theme: {\n    extend: {\n      colors: tailwindColors,\n    },\n  },\n  plugins: [\n    plugin(({ addVariant }) => {\n      addVariant(\"light\", ':root:not([data-theme=\"dark\"]) &');\n      addVariant(\"dark\", ':root[data-theme=\"dark\"] &');\n    }),\n  ],\n};\n```\n\n`theme.config.js`\n```js\n/** @type {const} */\nconst themeColors = {\n  primary: { light: '#0a7ea4', dark: '#0a7ea4' },\n  background: { light: '#ffffff', dark: '#151718' },\n  surface: { light: '#f5f5f5', dark: '#1e2022' },\n  foreground: { light: '#11181C', dark: '#ECEDEE' },\n  muted: { light: '#687076', dark: '#9BA1A6' },\n  border: { light: '#E5E7EB', dark: '#334155' },\n  success: { light: '#22C55E', dark: '#4ADE80' },\n  warning: { light: '#F59E0B', dark: '#FBBF24' },\n  error: { light: '#EF4444', dark: '#F87171' },\n};\n\nmodule.exports = { themeColors };\n```\n\n`app.config.ts`\n```ts\n// Load environment variables with proper priority (system > .env)\nimport \"./scripts/load-env.js\";\nimport type { ExpoConfig } from \"expo/config\";\n\n// Bundle ID format: space.manus.<project_name_dots>.<timestamp>\n// e.g., \"my-app\" created at 2024-01-15 10:30:45 -> \"space.manus.my.app.t20240115103045\"\nconst bundleId = \"{{bundle_id}}\";\n// Extract timestamp from bundle ID and prefix with \"manus\" for deep link scheme\n// e.g., \"space.manus.my.app.t20240115103045\" -> \"manus20240115103045\"\nconst timestamp = bundleId.split(\".\").pop()?.replace(/^t/, \"\") ?? \"\";\nconst schemeFromBundleId = `manus${timestamp}`;\n\nconst env = {\n  // App branding - update these values directly (do not use env vars)\n  appName: \"{{project_title}}\",\n  appSlug: \"{{project_name}}\",\n  // S3 URL of the app logo - set this to the URL returned by generate_image when creating custom logo\n  // Leave empty to use the default icon from assets/images/icon.png\n  logoUrl: \"\",\n  scheme: schemeFromBundleId,\n  iosBundleId: bundleId,\n  androidPackage: bundleId,\n};\n\nconst config: ExpoConfig = {\n  name: env.appName,\n  slug: env.appSlug,\n  version: \"1.0.0\",\n  orientation: \"portrait\",\n  icon: \"./assets/images/icon.png\",\n  scheme: env.scheme,\n  userInterfaceStyle: \"automatic\",\n  newArchEnabled: true,\n  ios: {\n    supportsTablet: true,\n    bundleIdentifier: env.iosBundleId,\n  },\n  android: {\n    adaptiveIcon: {\n      backgroundColor: \"#E6F4FE\",\n      foregroundImage: \"./assets/images/android-icon-foreground.png\",\n      backgroundImage: \"./assets/images/android-icon-background.png\",\n      monochromeImage: \"./assets/images/android-icon-monochrome.png\",\n    },\n    edgeToEdgeEnabled: true,\n    predictiveBackGestureEnabled: false,\n    package: env.androidPackage,\n    permissions: [\"POST_NOTIFICATIONS\"],\n    intentFilters: [\n      {\n        action: \"VIEW\",\n        autoVerify: true,\n        data: [\n          {\n            scheme: env.scheme,\n            host: \"*\",\n          },\n        ],\n        category: [\"BROWSABLE\", \"DEFAULT\"],\n      },\n    ],\n  },\n  web: {\n    bundler: \"metro\",\n    output: \"static\",\n    favicon: \"./assets/images/favicon.png\",\n  },\n  plugins: [\n    \"expo-router\",\n    [\n      \"expo-audio\",\n      {\n        microphonePermission: \"Allow $(PRODUCT_NAME) to access your microphone.\",\n      },\n    ],\n    [\n      \"expo-video\",\n      {\n        supportsBackgroundPlayback: true,\n        supportsPictureInPicture: true,\n      },\n    ],\n    [\n      \"expo-splash-screen\",\n      {\n        image: \"./assets/images/splash-icon.png\",\n        imageWidth: 200,\n        resizeMode: \"contain\",\n        backgroundColor: \"#ffffff\",\n        dark: {\n          backgroundColor: \"#000000\",\n        },\n      },\n    ],\n    [\n      \"expo-build-properties\",\n      {\n        android: {\n          buildArchs: [\"armeabi-v7a\", \"arm64-v8a\"],\n        },\n      },\n    ],\n  ],\n  experiments: {\n    typedRoutes: true,\n    reactCompiler: true,\n  },\n};\n\nexport default config;\n```\n\n`package.json`\n```json\n{\n  \"name\": \"app-template\",\n  \"version\": \"1.0.0\",\n  \"private\": true,\n  \"main\": \"expo-router/entry\",\n  \"scripts\": {\n    \"dev\": \"concurrently -k \\\"pnpm dev:server\\\" \\\"pnpm dev:metro\\\"\",\n    \"dev:server\": \"cross-env NODE_ENV=development tsx watch server/_core/index.ts\",\n    \"dev:metro\": \"cross-env EXPO_USE_METRO_WORKSPACE_ROOT=1 npx expo start --web --port ${EXPO_PORT:-8081}\",\n    \"build\": \"esbuild server/_core/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist\",\n    \"start\": \"NODE_ENV=production node dist/index.js\",\n    \"check\": \"tsc --noEmit\",\n    \"lint\": \"expo lint\",\n    \"format\": \"prettier --write .\",\n    \"test\": \"vitest run\",\n    \"db:push\": \"drizzle-kit generate && drizzle-kit migrate\",\n    \"android\": \"expo start --android\",\n    \"ios\": \"expo start --ios\",\n    \"qr\": \"node scripts/generate_qr.mjs\"\n  },\n  \"dependencies\": {\n    \"@expo/vector-icons\": \"^15.0.3\",\n    \"@react-native-async-storage/async-storage\": \"^2.2.0\",\n    \"@react-navigation/bottom-tabs\": \"^7.8.12\",\n    \"@react-navigation/elements\": \"^2.9.2\",\n    \"@react-navigation/native\": \"^7.1.25\",\n    \"@tanstack/react-query\": \"^5.90.12\",\n    \"@trpc/client\": \"11.7.2\",\n    \"@trpc/react-query\": \"11.7.2\",\n    \"@trpc/server\": \"11.7.2\",\n    \"axios\": \"^1.13.2\",\n    \"clsx\": \"^2.1.1\",\n    \"cookie\": \"^1.1.1\",\n    \"dotenv\": \"^16.6.1\",\n    \"drizzle-orm\": \"^0.44.7\",\n    \"expo\": \"~54.0.29\",\n    \"expo-audio\": \"~1.1.0\",\n    \"expo-build-properties\": \"^1.0.10\",\n    \"expo-constants\": \"~18.0.12\",\n    \"expo-font\": \"~14.0.10\",\n    \"expo-haptics\": \"~15.0.8\",\n    \"expo-image\": \"~3.0.11\",\n    \"expo-keep-awake\": \"~15.0.8\",\n    \"expo-linking\": \"~8.0.10\",\n    \"expo-notifications\": \"~0.32.15\",\n    \"expo-router\": \"~6.0.19\",\n    \"expo-secure-store\": \"~15.0.8\",\n    \"expo-splash-screen\": \"~31.0.12\",\n    \"expo-status-bar\": \"~3.0.9\",\n    \"expo-symbols\": \"~1.0.8\",\n    \"expo-system-ui\": \"~6.0.9\",\n    \"expo-video\": \"~3.0.15\",\n    \"expo-web-browser\": \"~15.0.10\",\n    \"express\": \"^4.22.1\",\n    \"jose\": \"6.1.0\",\n    \"mysql2\": \"^3.16.0\",\n    \"nativewind\": \"^4.2.1\",\n    \"react\": \"19.1.0\",\n    \"react-dom\": \"19.1.0\",\n    \"react-native\": \"0.81.5\",\n    \"react-native-gesture-handler\": \"~2.28.0\",\n    \"react-native-reanimated\": \"~4.1.6\",\n    \"react-native-safe-area-context\": \"~5.6.2\",\n    \"react-native-screens\": \"~4.16.0\",\n    \"react-native-svg\": \"15.12.1\",\n    \"react-native-web\": \"~0.21.2\",\n    \"react-native-worklets\": \"0.5.1\",\n    \"superjson\": \"^1.13.3\",\n    \"tailwind-merge\": \"^2.6.0\",\n    \"zod\": \"^4.2.1\"\n  },\n  \"devDependencies\": {\n    \"@expo/ngrok\": \"^4.1.3\",\n    \"@types/cookie\": \"^0.6.0\",\n    \"@types/express\": \"^4.17.25\",\n    \"@types/node\": \"^22.19.3\",\n    \"@types/qrcode\": \"^1.5.6\",\n    \"@types/react\": \"~19.1.17\",\n    \"concurrently\": \"^9.2.1\",\n    \"cross-env\": \"^7.0.3\",\n    \"drizzle-kit\": \"^0.31.8\",\n    \"esbuild\": \"^0.25.12\",\n    \"eslint\": \"^9.39.2\",\n    \"eslint-config-expo\": \"~10.0.0\",\n    \"prettier\": \"^3.7.4\",\n    \"qrcode\": \"^1.5.4\",\n    \"tailwindcss\": \"^3.4.17\",\n    \"tsx\": \"^4.21.0\",\n    \"typescript\": \"~5.9.3\",\n    \"vitest\": \"^2.1.9\"\n  },\n  \"packageManager\": \"pnpm@9.12.0\"\n}\n```",
  "web-static": "# Web App Template (Static Frontend)\n\nPure React 19 + Tailwind 4 template with shadcn/ui baked in. **Use this README as the checklist for shipping static experiences.**\n\n> **Note:** This template includes a minimal `shared/` and `server/` directory with placeholder types to support imported templates. These are just compatibility placeholders - web-static remains a true static-only template without API functionality.\n\n---\n\n## Stack Overview\n- Client-only routing powered by React + Wouter.\n- Design tokens live entirely in `client/src/index.css`‚Äîkeep that file intact.\n\n## File Structure\n\n```\nclient/\n  public/       ‚Üê Static assets copied verbatim to '/'\n  src/\n    pages/      ‚Üê Page-level components\n    components/ ‚Üê Reusable UI & shadcn/ui\n    contexts/   ‚Üê React contexts\n    hooks/      ‚Üê Custom React hooks\n    lib/        ‚Üê Utility helpers\n    App.tsx     ‚Üê Routes & top-level layout\n    main.tsx    ‚Üê React entry point\n    index.css   ‚Üê global style\nserver/         ‚Üê Placeholder for imported template compatibility\nshared/         ‚Üê Placeholder for imported template compatibility\n  const.ts      ‚Üê Shared constants\n```\n\nAssets placed under `client/public` are served with aggressive caching, so add a content hash to filenames (for example, `asset.3fa9b2e4.svg`) whenever you replace a file and update its references to avoid stale assets.\n\nFiles in `client/public` are available at the root of your site‚Äîreference them with absolute paths (`/asset.3fa9b2e4.svg`, `/robots.txt`, etc.) from HTML templates, JSX, or meta tags.\n\n---\n\n## üéØ Development Workflow\n\n1. **Choose a design style** before you write any frontend code according to Design Guide (color, font, shadow, art style). Tell user what you chose. Remember to edit `client/src/index.css` for global theming and add needed font using google font cdn in `client/index.html`.\n2. **Compose pages** in `client/src/pages/`. Keep sections modular so they can be reused across routes.\n3. **Share primitives** via `client/src/components/`‚Äîextend shadcn/ui when needed instead of duplicating markup.\n4. **Keep styling consistent** by relying on existing Tailwind tokens (spacing, colors, typography).\n5. **Fetch external data** with `useEffect` if the site needs dynamic content from public APIs.\n---\n\n## üé® Frontend Development Guidelines\n\n**UI & Styling:**\n- Prefer shadcn/ui components for interactions to keep a modern, consistent look; import from `@/components/ui/*` (e.g., `button`, `card`, `dialog`).\n- Compose Tailwind utilities with component variants for layout and states; avoid excessive custom CSS. Use built-in `variant`, `size`, etc. where available.\n- Preserve design tokens: keep the `@layer base` rules in `client/src/index.css`. Utilities like `border-border` and `font-sans` depend on them.\n- Consistent design language: use spacing, radius, shadows, and typography via tokens. Extract shared UI into `components/` for reuse instead of copy‚Äëpaste.\n- Accessibility and responsiveness: keep visible focus rings and ensure keyboard reachability; design mobile‚Äëfirst with thoughtful breakpoints.\n- Theming: Choose dark/light theme to start with for ThemeProvider according to your design style (dark or light bg), then manage colors pallette with CSS variables in `client/src/index.css` instead of hard‚Äëcoding to keep global consistency.\n- Micro‚Äëinteractions and empty states: add motion, empty states, and icons tastefully to improve quality without distracting from content.\n- Navigation: For internal tools/admin panels, use persistent sidebar. For public-facing apps, design navigation based on content structure (top nav, side nav, or contextual)‚Äîensure clear escape routes from all pages.\n- Placeholder UI elements: When adding structural placeholders (nav items, CTAs) for not-yet-implemented features, show toast on click (\"Feature coming soon\"). Inform user which elements are placeholders when presenting work.\n\n**React Best Practices:**\n- Never call setState/navigation in render phase ‚Üí wrap in `useEffect`\n\n**Customized Defaults:**\nThis template customizes some Tailwind/shadcn defaults for simplified usage:\n- `.container` is customized to auto-center and add responsive padding (see `index.css`). Use directly without `mx-auto`/`px-*`. For custom widths, use `max-w-*` with `mx-auto px-4`.\n- `.flex` is customized to have `min-width:0` and `min-height:0` by default\n- `button` variant `outline` uses transparent background (not `bg-background`). Add bg color class manually if needed.\n\n---\n\n## üé® Design Guide\n\nWhen generating frontend UI, avoid generic patterns that lack visual distinction:\n- Avoid generic full-page centered layouts‚Äîprefer asymmetric/sidebar/grid structures for landing pages and dashboards\n- When user provides vague requirements, make creative design decisions (choose specific color palette, typography, layout approach)\n- Prioritize visual diversity: combine different design systems (e.g., one color scheme + different typography + another layout principle)\n- For landing pages: prefer asymmetric layouts, specific color values (not just \"blue\"), and textured backgrounds over flat colors\n- For dashboards: use defined spacing systems, soft shadows over borders, and accent colors for hierarchy\n\n---\n\n## Pre-built Components\n\nBefore implementing UI features, check if these components already exist:\n\nMaps:\n- `client/src/components/Map.tsx` - Google Maps integration with proxy authentication. Provides MapView component with onMapReady callback for initializing Google Maps services (Places, Geocoder, Directions, Drawing, etc.). All map functionality works directly in the browser.\n\nWhen implementing features that match these categories, MUST evaluate the component first to decide whether to use or customize it.\n\n---\n\n## üó∫Ô∏è Maps Integration\n\n**CRITICAL: The Manus proxy provides FULL access to ALL Google Maps features** - including advanced drawing, heatmaps, Street View, all layers, Places API, etc. Do NOT ask users for Google Map API keys - authentication is automatic.\n\n**Implementation:**\n- Frontend: Import MapView from `client/src/components/Map.tsx` and initialize ANY Google Maps service (geocoding, directions, places, drawing, visualization, geometry, etc.) in the onMapReady callback. ALL Google Maps JavaScript API features work directly in the browser.\n\nNEVER use external map libraries or request API keys from users - the Manus proxy handles everything automatically with no feature limitations.\n\n---\n\n## ‚úÖ Launch Checklist\n- [ ] UI layout and navigation structure correct, all image src valid.\n- [ ] Success + error paths verified in the browser\n\n---\n\n## Core File References\n\n`package.json`\n```tsx\n{\n  \"name\": \"{{project_name}}\",\n  \"version\": \"1.0.0\",\n  \"type\": \"module\",\n  \"license\": \"MIT\",\n  \"scripts\": {\n    \"dev\": \"vite --host\",\n    \"build\": \"vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist\",\n    \"start\": \"NODE_ENV=production node dist/index.js\",\n    \"preview\": \"vite preview --host\",\n    \"check\": \"tsc --noEmit\",\n    \"format\": \"prettier --write .\"\n  },\n  \"dependencies\": {\n    \"@hookform/resolvers\": \"^5.2.2\",\n    \"@radix-ui/react-accordion\": \"^1.2.12\",\n    \"@radix-ui/react-alert-dialog\": \"^1.1.15\",\n    \"@radix-ui/react-aspect-ratio\": \"^1.1.7\",\n    \"@radix-ui/react-avatar\": \"^1.1.10\",\n    \"@radix-ui/react-checkbox\": \"^1.3.3\",\n    \"@radix-ui/react-collapsible\": \"^1.1.12\",\n    \"@radix-ui/react-context-menu\": \"^2.2.16\",\n    \"@radix-ui/react-dialog\": \"^1.1.15\",\n    \"@radix-ui/react-dropdown-menu\": \"^2.1.16\",\n    \"@radix-ui/react-hover-card\": \"^1.1.15\",\n    \"@radix-ui/react-label\": \"^2.1.7\",\n    \"@radix-ui/react-menubar\": \"^1.1.16\",\n    \"@radix-ui/react-navigation-menu\": \"^1.2.14\",\n    \"@radix-ui/react-popover\": \"^1.1.15\",\n    \"@radix-ui/react-progress\": \"^1.1.7\",\n    \"@radix-ui/react-radio-group\": \"^1.3.8\",\n    \"@radix-ui/react-scroll-area\": \"^1.2.10\",\n    \"@radix-ui/react-select\": \"^2.2.6\",\n    \"@radix-ui/react-separator\": \"^1.1.7\",\n    \"@radix-ui/react-slider\": \"^1.3.6\",\n    \"@radix-ui/react-slot\": \"^1.2.3\",\n    \"@radix-ui/react-switch\": \"^1.2.6\",\n    \"@radix-ui/react-tabs\": \"^1.1.13\",\n    \"@radix-ui/react-toggle\": \"^1.1.10\",\n    \"@radix-ui/react-toggle-group\": \"^1.1.11\",\n    \"@radix-ui/react-tooltip\": \"^1.2.8\",\n    \"axios\": \"^1.12.0\",\n    \"class-variance-authority\": \"^0.7.1\",\n    \"clsx\": \"^2.1.1\",\n    \"cmdk\": \"^1.1.1\",\n    \"embla-carousel-react\": \"^8.6.0\",\n    \"express\": \"^4.21.2\",\n    \"framer-motion\": \"^12.23.22\",\n    \"input-otp\": \"^1.4.2\",\n    \"lucide-react\": \"^0.453.0\",\n    \"nanoid\": \"^5.1.5\",\n    \"next-themes\": \"^0.4.6\",\n    \"react\": \"^19.2.1\",\n    \"react-day-picker\": \"^9.11.1\",\n    \"react-dom\": \"^19.2.1\",\n    \"react-hook-form\": \"^7.64.0\",\n    \"react-resizable-panels\": \"^3.0.6\",\n    \"recharts\": \"^2.15.2\",\n    \"sonner\": \"^2.0.7\",\n    \"streamdown\": \"^1.4.0\",\n    \"tailwind-merge\": \"^3.3.1\",\n    \"tailwindcss-animate\": \"^1.0.7\",\n    \"vaul\": \"^1.1.2\",\n    \"wouter\": \"^3.3.5\",\n    \"zod\": \"^4.1.12\"\n  },\n  \"devDependencies\": {\n    \"@builder.io/vite-plugin-jsx-loc\": \"^0.1.1\",\n    \"@tailwindcss/typography\": \"^0.5.15\",\n    \"@tailwindcss/vite\": \"^4.1.3\",\n    \"@types/express\": \"4.17.21\",\n    \"@types/google.maps\": \"^3.58.1\",\n    \"@types/node\": \"^24.7.0\",\n    \"@types/react\": \"^19.2.1\",\n    \"@types/react-dom\": \"^19.2.1\",\n    \"@vitejs/plugin-react\": \"^5.0.4\",\n    \"add\": \"^2.0.6\",\n    \"autoprefixer\": \"^10.4.20\",\n    \"esbuild\": \"^0.25.0\",\n    \"pnpm\": \"^10.15.1\",\n    \"postcss\": \"^8.4.47\",\n    \"prettier\": \"^3.6.2\",\n    \"tailwindcss\": \"^4.1.14\",\n    \"tsx\": \"^4.19.1\",\n    \"tw-animate-css\": \"^1.4.0\",\n    \"typescript\": \"5.6.3\",\n    \"vite\": \"^7.1.7\",\n    \"vite-plugin-manus-runtime\": \"^0.0.57\",\n    \"vitest\": \"^2.1.4\"\n  },\n  \"packageManager\": \"pnpm@10.4.1+sha512.c753b6c3ad7afa13af388fa6d808035a008e30ea9993f58c6663e2bc5ff21679aa834db094987129aa4d488b86df57f7b634981b2f827cdcacc698cc0cfb88af\",\n  \"pnpm\": {\n    \"patchedDependencies\": {\n      \"wouter@3.7.1\": \"patches/wouter@3.7.1.patch\"\n    },\n    \"overrides\": {\n      \"tailwindcss>nanoid\": \"3.3.7\"\n    }\n  }\n}\n```\n\n`client/src/App.tsx`\n```tsx\nimport { Toaster } from \"@/components/ui/sonner\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport NotFound from \"@/pages/NotFound\";\nimport { Route, Switch } from \"wouter\";\nimport ErrorBoundary from \"./components/ErrorBoundary\";\nimport { ThemeProvider } from \"./contexts/ThemeContext\";\nimport Home from \"./pages/Home\";\n\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path={\"/\"} component={Home} />\n      <Route path={\"/404\"} component={NotFound} />\n      {/* Final fallback route */}\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\n// NOTE: About Theme\n// - First choose a default theme according to your design style (dark or light bg), than change color palette in index.css\n//   to keep consistent foreground/background color across components\n// - If you want to make theme switchable, pass `switchable` ThemeProvider and use `useTheme` hook\n\nfunction App() {\n  return (\n    <ErrorBoundary>\n      <ThemeProvider\n        defaultTheme=\"light\"\n        // switchable\n      >\n        <TooltipProvider>\n          <Toaster />\n          <Router />\n        </TooltipProvider>\n      </ThemeProvider>\n    </ErrorBoundary>\n  );\n}\n\nexport default App;\n```\n\n`client/src/pages/Home.tsx`\n```tsx\nimport { Button } from \"@/components/ui/button\";\nimport { Loader2 } from \"lucide-react\";\nimport { Streamdown } from 'streamdown';\n\n/**\n * All content in this page are only for example, replace with your own feature implementation\n * When building pages, remember your instructions in Frontend Best Practices, Design Guide and Common Pitfalls\n */\nexport default function Home() {\n  // If theme is switchable in App.tsx, we can implement theme toggling like this:\n  // const { theme, toggleTheme } = useTheme();\n\n  return (\n    <div className=\"min-h-screen flex flex-col\">\n      <main>\n        {/* Example: lucide-react for icons */}\n        <Loader2 className=\"animate-spin\" />\n        Example Page\n        {/* Example: Streamdown for markdown rendering */}\n        <Streamdown>Any **markdown** content</Streamdown>\n        <Button variant=\"default\">Example Button</Button>\n      </main>\n    </div>\n  );\n}\n```\n\n`client/src/index.css`\n```tsx\n@import \"tailwindcss\";\n@import \"tw-animate-css\";\n\n@custom-variant dark (&:is(.dark *));\n\n@theme inline {\n  --radius-sm: calc(var(--radius) - 4px);\n  --radius-md: calc(var(--radius) - 2px);\n  --radius-lg: var(--radius);\n  --radius-xl: calc(var(--radius) + 4px);\n  --color-background: var(--background);\n  --color-foreground: var(--foreground);\n  --color-card: var(--card);\n  --color-card-foreground: var(--card-foreground);\n  --color-popover: var(--popover);\n  --color-popover-foreground: var(--popover-foreground);\n  --color-primary: var(--primary);\n  --color-primary-foreground: var(--primary-foreground);\n  --color-secondary: var(--secondary);\n  --color-secondary-foreground: var(--secondary-foreground);\n  --color-muted: var(--muted);\n  --color-muted-foreground: var(--muted-foreground);\n  --color-accent: var(--accent);\n  --color-accent-foreground: var(--accent-foreground);\n  --color-destructive: var(--destructive);\n  --color-destructive-foreground: var(--destructive-foreground);\n  --color-border: var(--border);\n  --color-input: var(--input);\n  --color-ring: var(--ring);\n  --color-chart-1: var(--chart-1);\n  --color-chart-2: var(--chart-2);\n  --color-chart-3: var(--chart-3);\n  --color-chart-4: var(--chart-4);\n  --color-chart-5: var(--chart-5);\n  --color-sidebar: var(--sidebar);\n  --color-sidebar-foreground: var(--sidebar-foreground);\n  --color-sidebar-primary: var(--sidebar-primary);\n  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);\n  --color-sidebar-accent: var(--sidebar-accent);\n  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);\n  --color-sidebar-border: var(--sidebar-border);\n  --color-sidebar-ring: var(--sidebar-ring);\n}\n\n:root {\n  --primary: var(--color-blue-700);\n  --primary-foreground: var(--color-blue-50);\n  --sidebar-primary: var(--color-blue-600);\n  --sidebar-primary-foreground: var(--color-blue-50);\n  --chart-1: var(--color-blue-300);\n  --chart-2: var(--color-blue-500);\n  --chart-3: var(--color-blue-600);\n  --chart-4: var(--color-blue-700);\n  --chart-5: var(--color-blue-800);\n  --radius: 0.65rem;\n  --background: oklch(1 0 0);\n  --foreground: oklch(0.235 0.015 65);\n  --card: oklch(1 0 0);\n  --card-foreground: oklch(0.235 0.015 65);\n  --popover: oklch(1 0 0);\n  --popover-foreground: oklch(0.235 0.015 65);\n  --secondary: oklch(0.98 0.001 286.375);\n  --secondary-foreground: oklch(0.4 0.015 65);\n  --muted: oklch(0.967 0.001 286.375);\n  --muted-foreground: oklch(0.552 0.016 285.938);\n  --accent: oklch(0.967 0.001 286.375);\n  --accent-foreground: oklch(0.141 0.005 285.823);\n  --destructive: oklch(0.577 0.245 27.325);\n  --destructive-foreground: oklch(0.985 0 0);\n  --border: oklch(0.92 0.004 286.32);\n  --input: oklch(0.92 0.004 286.32);\n  --ring: oklch(0.623 0.214 259.815);\n  --sidebar: oklch(0.985 0 0);\n  --sidebar-foreground: oklch(0.235 0.015 65);\n  --sidebar-accent: oklch(0.967 0.001 286.375);\n  --sidebar-accent-foreground: oklch(0.141 0.005 285.823);\n  --sidebar-border: oklch(0.92 0.004 286.32);\n  --sidebar-ring: oklch(0.623 0.214 259.815);\n}\n\n.dark {\n  --primary: var(--color-blue-700);\n  --primary-foreground: var(--color-blue-50);\n  --sidebar-primary: var(--color-blue-500);\n  --sidebar-primary-foreground: var(--color-blue-50);\n  --background: oklch(0.141 0.005 285.823);\n  --foreground: oklch(0.85 0.005 65);\n  --card: oklch(0.21 0.006 285.885);\n  --card-foreground: oklch(0.85 0.005 65);\n  --popover: oklch(0.21 0.006 285.885);\n  --popover-foreground: oklch(0.85 0.005 65);\n  --secondary: oklch(0.24 0.006 286.033);\n  --secondary-foreground: oklch(0.7 0.005 65);\n  --muted: oklch(0.274 0.006 286.033);\n  --muted-foreground: oklch(0.705 0.015 286.067);\n  --accent: oklch(0.274 0.006 286.033);\n  --accent-foreground:  oklch(0.92 0.005 65);\n  --destructive: oklch(0.704 0.191 22.216);\n  --destructive-foreground: oklch(0.985 0 0);\n  --border: oklch(1 0 0 / 10%);\n  --input: oklch(1 0 0 / 15%);\n  --ring: oklch(0.488 0.243 264.376);\n  --chart-1: var(--color-blue-300);\n  --chart-2: var(--color-blue-500);\n  --chart-3: var(--color-blue-600);\n  --chart-4: var(--color-blue-700);\n  --chart-5: var(--color-blue-800);\n  --sidebar: oklch(0.21 0.006 285.885);\n  --sidebar-foreground: oklch(0.85 0.005 65);\n  --sidebar-accent: oklch(0.274 0.006 286.033);\n  --sidebar-accent-foreground:  oklch(0.985 0 0);\n  --sidebar-border: oklch(1 0 0 / 10%);\n  --sidebar-ring: oklch(0.488 0.243 264.376);\n}\n\n@layer base {\n  * {\n    @apply border-border outline-ring/50;\n  }\n  body {\n    @apply bg-background text-foreground;\n  }\n  button:not(:disabled),\n  [role=\"button\"]:not([aria-disabled=\"true\"]),\n  [type=\"button\"]:not(:disabled),\n  [type=\"submit\"]:not(:disabled),\n  [type=\"reset\"]:not(:disabled),\n  a[href],\n  select:not(:disabled),\n  input[type=\"checkbox\"]:not(:disabled),\n  input[type=\"radio\"]:not(:disabled) {\n    @apply cursor-pointer;\n  }\n}\n\n@layer components {\n  /**\n   * Custom container utility that centers content and adds responsive padding.\n   *\n   * This overrides Tailwind's default container behavior to:\n   * - Auto-center content (mx-auto)\n   * - Add responsive horizontal padding\n   * - Set max-width for large screens\n   *\n   * Usage: <div className=\"container\">...</div>\n   *\n   * For custom widths, use max-w-* utilities directly:\n   * <div className=\"max-w-6xl mx-auto px-4\">...</div>\n   */\n  .container {\n    width: 100%;\n    margin-left: auto;\n    margin-right: auto;\n    padding-left: 1rem; /* 16px - mobile padding */\n    padding-right: 1rem;\n  }\n\n  .flex {\n    min-height: 0;\n    min-width: 0;\n  }\n\n  @media (min-width: 640px) {\n    .container {\n      padding-left: 1.5rem; /* 24px - tablet padding */\n      padding-right: 1.5rem;\n    }\n  }\n\n  @media (min-width: 1024px) {\n    .container {\n      padding-left: 2rem; /* 32px - desktop padding */\n      padding-right: 2rem;\n      max-width: 1280px; /* Standard content width */\n    }\n  }\n}\n```\n\n`client/index.html`\n```tsx\n<!doctype html>\n<html lang=\"en\">\n\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta\n      name=\"viewport\"\n      content=\"width=device-width, initial-scale=1.0, maximum-scale=1\" />\n    <title>{{project_title}}</title>    \n    <!-- THIS IS THE START OF A COMMENT BLOCK, BLOCK TO BE DELETED: Google Fonts here, example:\n    <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\" />\n    <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin />\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap\" rel=\"stylesheet\" />\n    THIS IS THE END OF A COMMENT BLOCK, BLOCK TO BE DELETED -->\n  </head>\n\n  <body>\n    <div id=\"root\"></div>\n    <script type=\"module\" src=\"/src/main.tsx\"></script>\n    <script\n      defer\n      src=\"%VITE_ANALYTICS_ENDPOINT%/umami\"\n      data-website-id=\"%VITE_ANALYTICS_WEBSITE_ID%\"></script>\n  </body>\n\n</html>\n```\n\n`server/index.ts`\n```tsx\nimport express from \"express\";\nimport { createServer } from \"http\";\nimport path from \"path\";\nimport { fileURLToPath } from \"url\";\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nasync function startServer() {\n  const app = express();\n  const server = createServer(app);\n\n  // Serve static files from dist/public in production\n  const staticPath =\n    process.env.NODE_ENV === \"production\"\n      ? path.resolve(__dirname, \"public\")\n      : path.resolve(__dirname, \"..\", \"dist\", \"public\");\n\n  app.use(express.static(staticPath));\n\n  // Handle client-side routing - serve index.html for all routes\n  app.get(\"*\", (_req, res) => {\n    res.sendFile(path.join(staticPath, \"index.html\"));\n  });\n\n  const port = process.env.PORT || 3000;\n\n  server.listen(port, () => {\n    console.log(`Server running on http://localhost:${port}/`);\n  });\n}\n\nstartServer().catch(console.error);\n```\n---\n\n## Common Pitfalls\n\n### Infinite loading loops from unstable references\n**Anti-pattern:** Creating new objects/arrays in render that are used as query inputs\n```tsx\n// ‚ùå Bad: New Date() creates new reference every render ‚Üí infinite queries\nconst { data } = trpc.items.getByDate.useQuery({\n  date: new Date(), // ‚Üê New object every render!\n});\n\n// ‚ùå Bad: Array/object literals in query input\nconst { data } = trpc.items.getByIds.useQuery({\n  ids: [1, 2, 3], // ‚Üê New array reference every render!\n});\n```\n\n**Correct approach:** Stabilize references with useState/useMemo\n```tsx\n// ‚úÖ Good: Initialize once with useState\nconst [date] = useState(() => new Date());\nconst { data } = trpc.items.getByDate.useQuery({ date });\n\n// ‚úÖ Good: Memoize complex inputs\nconst ids = useMemo(() => [1, 2, 3], []);\nconst { data } = trpc.items.getByIds.useQuery({ ids });\n```\n\n**Why this happens:** TRPC queries trigger when input references change. Objects/arrays created in render have new references each time, causing infinite re-fetches.\n\n### Navigation dead-ends in subpages\n**Problem:** Creating nested routes without escape routes‚Äîno header nav, no sidebar, no back button.\n\n**Root cause:** Implementing individual pages before establishing global layout structure.\n\n**Solution:** Define layout wrapper in App.tsx first, then build pages inside it. For admin tools use DashboardLayout; for detail pages add back button with `router.back()`.\n\n### Invisible text from theme/color mismatches\n\n**Root cause:** Semantic colors (`bg-background`, `text-foreground`) are CSS variables that resolve based on ThemeProvider's active theme. Mismatches cause invisible text.\n\n**Two critical rules:**\n\n1. **Match theme to CSS variables:** If `defaultTheme=\"dark\"` in App.tsx, ensure `.dark {}` in index.css has dark background + light foreground values\n2. **Always pair bg with text:** When using `bg-{semantic}`, MUST also use `text-{semantic}-foreground` (not automatic - text inherits from parent otherwise)\n\n**Quick reference:**\n```tsx\n// ‚úÖ Theme + CSS alignment\n<ThemeProvider defaultTheme=\"dark\">  {/* Must match .dark in index.css */}\n  <div className=\"bg-background text-foreground\">...</div>\n</ThemeProvider>\n\n// ‚úÖ Required class pairs\n<div className=\"bg-popover text-popover-foreground\">...</div>\n<div className=\"bg-card text-card-foreground\">...</div>\n<div className=\"bg-accent text-accent-foreground\">...</div>\n```\n\n### Nested anchor tags in Link components\n**Problem:** Wrapping `<a>` tags inside another `<a>` or wouter's `<Link>` creates nested anchors and runtime errors.\n\n**Solution:** Pass children directly to Link‚Äîit already renders an `<a>` internally.\n```tsx\n// ‚ùå Bad: <Link><a>...</a></Link> or <a><a>...</a></a>\n// ‚úÖ Good: <Link>...</Link> or just <a>...</a>\n```\n### Empty `Select.Item` values\n\n**Rule:** Every `<Select.Item>` must have a non-empty `value` prop‚Äînever `\"\"`, `undefined`, or omitted.\n\n**Rule:** Use sonner for toasts; do not add react-toastify or @radix-ui/react-toast\n\n**Rule:** If you put placeholder components for App.tsx routes, you MUST replace them with actual components after your implementation."
}